import Spline from '../libs/Spline';

class Owl  {
  constructor(pos){

    this.spline = new Spline([]);

    this.lines = [
      [[586, 446, 0],[587, 413, 0],[582, 395, 0],[576, 390, 0],[567, 397, 0],[556, 410, 0],[547, 423, 0],[536, 425, 0],[527, 413, 0],[525, 397, 0],[525, 379, 0],[526, 370, 0],[516, 378, 0],[505, 382, 0],[497, 380, 0],[498, 371, 0],[501, 373, 0],[498, 365, 0],[493, 363, 0],[487, 364, 0],[486, 368, 0],[491, 374, 0],[482, 370, 0],[481, 362, 0],[485, 361, 0],[483, 353, 0],[489, 349, 0],[494, 349, 0],[498, 353, 0],[502, 351, 0],[512, 363, 0],[518, 363, 0],[538, 354, 0],[550, 354, 0],[559, 360, 0],[566, 360, 0],[567, 365, 0],[558, 372, 0],[559, 358, 0],[568, 358, 0],[568, 367, 0],[573, 368, 0],[560, 375, 0],[568, 367, 0],[574, 370, 0],[553, 389, 0],[547, 390, 0],[547, 385, 0],[553, 377, 0],[553, 388, 0],[548, 388, 0],[552, 378, 0],[550, 368, 0],[548, 373, 0],[548, 360, 0],[555, 353, 0],[565, 358, 0],[572, 358, 0],[580, 325, 0],[573, 293, 0],[546, 236, 0]],
      // [[546, 598, 0],[560, 583, 0],[556, 551, 0],[537, 527, 0],[508, 487, 0],[501, 451, 0],[508, 415, 0],[524, 390, 0],[528, 378, 0],[520, 357, 0],[507, 329, 0],[500, 293, 0],[500, 263, 0],[508, 244, 0],[528, 236, 0],[549, 242, 0],[559, 257, 0],[557, 278, 0],[547, 289, 0],[525, 296, 0],[508, 292, 0],[495, 282, 0],[488, 257, 0],[484, 233, 0],[473, 213, 0],[441, 189, 0],[402, 172, 0],[352, 154, 0],[334, 149, 0],[331, 153, 0],[338, 162, 0],[326, 156, 0],[319, 158, 0],[320, 163, 0],[332, 177, 0],[326, 179, 0],[324, 187, 0],[332, 219, 0],[352, 262, 0],[378, 297, 0],[413, 331, 0],[448, 354, 0],[495, 374, 0],[555, 387, 0],[600, 384, 0],[626, 370, 0],[638, 348, 0],[640, 309, 0],[629, 269, 0],[612, 231, 0],[591, 205, 0],[573, 187, 0],[547, 166, 0],[526, 153, 0],[512, 144, 0],[510, 148, 0],[516, 163, 0],[525, 178, 0],[517, 173, 0],[513, 175, 0],[517, 185, 0],[529, 196, 0],[523, 197, 0],[525, 208, 0],[547, 243, 0],[575, 285, 0],[636, 335, 0],[610, 323, 0],[657, 341, 0],[671, 328, 0],[672, 301, 0],[658, 274, 0],[658, 274, 0],[658, 272, 0],[658, 272, 0]],
      // [[526, 285, 0],[525, 278, 0],[519, 277, 0],[515, 282, 0],[519, 292, 0],[525, 285, 0],[534, 282, 0],[542, 274, 0],[544, 266, 0],[539, 259, 0],[533, 258, 0],[528, 262, 0],[527, 269, 0],[529, 274, 0],[534, 276, 0],[541, 270, 0],[541, 266, 0],[538, 260, 0],[534, 261, 0],[531, 265, 0],[528, 273, 0],[525, 268, 0],[529, 256, 0],[542, 248, 0],[550, 243, 0],[558, 231, 0],[571, 214, 0],[583, 199, 0],[602, 186, 0],[623, 193, 0],[634, 217, 0],[624, 237, 0],[600, 240, 0],[592, 227, 0]],
      // [[526, 285, 0],[521, 294, 0],[507, 289, 0],[499, 275, 0],[500, 260, 0],[505, 256, 0],[513, 267, 0],[515, 273, 0],[512, 276, 0],[508, 272, 0],[507, 266, 0],[510, 262, 0],[503, 254, 0],[499, 251, 0],[499, 241, 0],[508, 228, 0],[518, 221, 0],[516, 208, 0],[500, 200, 0],[483, 199, 0],[475, 209, 0],[472, 221, 0],[484, 225, 0],[489, 210, 0],[477, 189, 0],[451, 189, 0]],
      [[525, 512, 0],[510, 489, 0],[502, 460, 0],[504, 434, 0],[512, 407, 0],[528, 383, 0],[526, 368, 0],[516, 349, 0],[507, 329, 0],[501, 303, 0],[499, 280, 0],[499, 265, 0],[503, 251, 0],[510, 241, 0],[519, 235, 0],[531, 233, 0],[543, 235, 0],[554, 245, 0],[559, 256, 0],[559, 270, 0],[554, 281, 0],[543, 289, 0],[533, 294, 0],[520, 295, 0],[507, 291, 0],[498, 283, 0],[490, 264, 0],[487, 240, 0],[479, 219, 0],[465, 205, 0],[413, 176, 0],[364, 157, 0],[336, 149, 0],[330, 151, 0],[335, 157, 0],[338, 160, 0],[324, 153, 0],[318, 157, 0],[331, 173, 0],[326, 175, 0],[324, 188, 0],[337, 229, 0],[356, 265, 0],[384, 301, 0],[417, 334, 0],[448, 354, 0],[480, 368, 0],[516, 380, 0],[579, 388, 0],[610, 381, 0],[634, 358, 0],[641, 330, 0],[639, 299, 0],[629, 266, 0],[612, 232, 0],[593, 207, 0],[570, 184, 0],[546, 166, 0],[527, 153, 0],[514, 144, 0],[511, 144, 0],[513, 155, 0],[525, 177, 0],[516, 173, 0],[514, 177, 0],[525, 196, 0],[523, 196, 0],[528, 213, 0],[547, 243, 0],[569, 279, 0],[589, 304, 0],[608, 324, 0],[628, 335, 0],[640, 341, 0]],
      [[501, 208, 0],[503, 201, 0],[510, 199, 0], [518, 210, 0], [516, 219, 0],[505, 234, 0],[498, 247, 0],[500, 253, 0],[509, 262, 0],[514, 270, 0],[515, 276, 0],[510, 275, 0],[508, 269, 0],[509, 261, 0],[504, 257, 0],[501, 261, 0],[499, 272, 0],[503, 285, 0],[509, 290, 0],[518, 294, 0],[525, 288, 0],[526, 285, 0],[524, 278, 0],[518, 278, 0],[515, 282, 0],[518, 291, 0],[525, 285, 0],[536, 280, 0],[542, 273, 0],[542, 264, 0],[536, 258, 0],[530, 261, 0],[527, 267, 0],[529, 274, 0],[535, 276, 0],[542, 271, 0],[542, 263, 0],[536, 257, 0],[531, 261, 0],[528, 265, 0],[525, 275, 0],[525, 259, 0],[534, 251, 0],[547, 246, 0],[559, 231, 0],[569, 226, 0],[580, 231, 0],[579, 244, 0]]
    ]

    // this.lines = [
    //   [[539, 708, 0],[552, 699, 0],[552, 690, 0],[538, 684, 0],[524, 672, 0],[518, 658, 0],[525, 647, 0],[536, 640, 0],[551, 632, 0],[569, 627, 0],[586, 613, 0],[591, 598, 0],[579, 582, 0],[561, 574, 0],[542, 567, 0],[529, 559, 0],[525, 547, 0],[532, 536, 0],[550, 523, 0],[564, 508, 0],[577, 489, 0],[585, 464, 0],[587, 433, 0],[583, 399, 0],[576, 392, 0],[565, 398, 0],[555, 412, 0],[542, 424, 0],[530, 419, 0],[525, 402, 0],[524, 383, 0],[527, 372, 0],[512, 381, 0],[496, 381, 0],[496, 374, 0],[499, 367, 0],[491, 365, 0],[484, 369, 0],[488, 374, 0],[482, 368, 0],[483, 362, 0],[482, 355, 0],[486, 351, 0],[494, 352, 0],[497, 354, 0],[501, 352, 0],[514, 367, 0],[530, 358, 0],[547, 356, 0],[558, 362, 0],[564, 359, 0],[567, 367, 0],[557, 374, 0],[559, 359, 0],[565, 358, 0],[568, 366, 0],[573, 370, 0],[565, 378, 0],[559, 378, 0],[561, 372, 0],[568, 366, 0],[574, 369, 0],[556, 387, 0],[546, 387, 0],[551, 377, 0],[554, 384, 0],[546, 384, 0],[553, 376, 0],[550, 368, 0],[546, 373, 0],[546, 362, 0],[555, 353, 0],[562, 357, 0],[567, 360, 0],[574, 356, 0],[580, 324, 0],[567, 274, 0],[537, 226, 0],[509, 184, 0],[490, 122, 0],[501, 75, 0],[527, 52, 0],[561, 24, 0],[570, 8, 0],[550, -6, 0],[515, -22, 0],[486, -42, 0],[488, -64, 0]],
    //   [[532, 701, 0],[519, 696, 0],[522, 684, 0],[533, 671, 0],[547, 655, 0],[566, 633, 0],[568, 610, 0],[542, 600, 0],[502, 598, 0],[489, 606, 0],[494, 613, 0],[524, 609, 0],[558, 590, 0],[561, 571, 0],[555, 548, 0],[534, 523, 0],[514, 496, 0],[502, 454, 0],[507, 424, 0],[518, 397, 0],[528, 380, 0],[523, 358, 0],[508, 334, 0],[501, 301, 0],[499, 281, 0],[502, 254, 0],[514, 238, 0],[533, 237, 0],[555, 248, 0],[559, 265, 0],[555, 283, 0],[541, 293, 0],[517, 296, 0],[499, 286, 0],[489, 264, 0],[486, 238, 0],[479, 218, 0],[457, 200, 0],[426, 184, 0],[387, 167, 0],[354, 154, 0],[332, 151, 0],[331, 154, 0],[338, 160, 0],[327, 155, 0],[319, 155, 0],[319, 161, 0],[331, 174, 0],[325, 178, 0],[325, 194, 0],[340, 237, 0],[361, 275, 0],[382, 302, 0],[411, 330, 0],[439, 348, 0],[490, 371, 0],[533, 384, 0],[577, 388, 0],[611, 380, 0],[633, 361, 0],[640, 334, 0],[638, 300, 0],[630, 268, 0],[615, 236, 0],[595, 209, 0],[574, 187, 0],[548, 167, 0],[528, 154, 0],[514, 143, 0],[511, 144, 0],[514, 158, 0],[525, 176, 0],[524, 176, 0],[516, 173, 0],[514, 176, 0],[528, 198, 0],[525, 198, 0],[522, 197, 0],[555, 257, 0],[587, 302, 0],[623, 334, 0],[650, 340, 0],[664, 336, 0],[672, 319, 0],[670, 295, 0],[650, 262, 0],[615, 219, 0],[554, 150, 0],[528, 115, 0],[513, 85, 0],[510, 63, 0],[524, 28, 0],[546, -6, 0],[559, -47, 0]],
    //   [[849, 148, 0],[855, 172, 0],[852, 200, 0],[839, 229, 0],[822, 243, 0],[798, 240, 0],[768, 225, 0],[741, 217, 0],[718, 220, 0],[701, 231, 0],[693, 249, 0],[696, 261, 0],[715, 267, 0],[731, 257, 0],[731, 234, 0],[709, 196, 0],[683, 173, 0],[659, 164, 0],[628, 170, 0],[602, 184, 0],[576, 206, 0],[559, 234, 0],[548, 246, 0],[535, 251, 0],[527, 258, 0],[525, 269, 0],[527, 278, 0],[527, 272, 0],[529, 261, 0],[538, 259, 0],[542, 265, 0],[542, 271, 0],[538, 275, 0],[532, 273, 0],[526, 266, 0],[531, 260, 0],[540, 259, 0],[543, 265, 0],[542, 273, 0],[535, 280, 0],[529, 283, 0],[520, 286, 0],[520, 288, 0],[522, 292, 0],[527, 281, 0],[523, 277, 0],[518, 277, 0],[516, 281, 0],[516, 286, 0],[520, 292, 0],[506, 287, 0],[499, 277, 0],[500, 265, 0],[503, 258, 0],[508, 258, 0],[512, 266, 0],[514, 271, 0],[514, 274, 0],[509, 270, 0],[509, 264, 0],[507, 257, 0],[500, 252, 0],[499, 243, 0],[506, 231, 0],[543, 188, 0],[557, 158, 0],[559, 124, 0],[549, 95, 0],[531, 74, 0],[516, 47, 0],[518, 21, 0],[535, 0, 0],[562, -17, 0],[575, -34, 0]]
    // ]


    // pos = [-.4, .4, 0]
    // pos[1] -= 2;

    this.eyes = [[534, 270, 0],[509, 271, 0]]
    this.offsetEyes = [0,0, -.2]

    this.remapVertices();

  }

  remapVertices(){
    let minX = 10000;
    let maxX = 0;

    let minY = 10000;
    let maxY = 0;

    for (var i = 0; i < this.lines.length; i++) {
      let l = this.lines[i]
      for (var k = 0; k < l.length; k++) {
        let v = l[k];
        if(v[0] < minX) minX = v[0]
        if(v[0] > maxX) maxX = v[0]

        if(v[1] < minY) minY = v[1]
        if(v[1] > maxY) maxY = v[1]
      }
    }

    this.wX = maxX - minX;
    this.wY = maxY - minY;
    let w = Math.max(this.wX, this.wY)

    this.tick = 0;

    let xMin = null;
    let xMax = null;
    let yMin = null;
    let yMax = null;
    let zMin = null;
    let zMax = null;

    for (var i = 0; i < this.eyes.length; i++) {
      this.eyes[i][0] /= (w/3);
			this.eyes[i][1] /= (w/3);
			this.eyes[i][2] = this.offsetEyes[2];
      // console.log(this.eyes[i]);
    }

    for (var i = 0; i < this.lines.length; i++) {
      let l = this.lines[i]

      for (var k = 0; k < l.length; k++) {

			  this.tick++;

  			l[k][0] /= (w/3);
  			l[k][1] /= (w/3);
  			l[k][2] = Math.cos(this.tick/6) * .2;


        if(l[k][0] < xMin || xMin === null) xMin = l[k][0];
        if(l[k][0] > xMax || xMax === null) xMax = l[k][0];

        if(l[k][1] < yMin || yMin === null) yMin = l[k][1];
        if(l[k][1] > yMax || yMax === null) yMax = l[k][1];

        if(l[k][2] < zMin || zMin === null) zMin = l[k][2];
        if(l[k][2] > zMax || zMax === null) zMax = l[k][2];
  		}
    }


    this.centerX = (xMax + xMin) /2;
    this.centerY = (yMax + yMin) /2;
    this.centerZ = (zMax + zMin) /2;

    var translation = [
      -.25,-2.4,0
    ]

    this.translationAnchor = [
      -this.centerX,
      -this.centerY,
      -this.centerZ
    ]


    this.m = mat4.create();
    this.mTAnchor = mat4.create();
    this.mT = mat4.create();

    mat4.identity(this.mTAnchor, this.mTAnchor);
    mat4.translate(this.mTAnchor, this.mTAnchor, this.translationAnchor);
    mat4.translate(this.mT, this.mT, translation);




    mat4.identity(this.m);
    mat4.multiply(this.m, this.m, this.mT);
    mat4.multiply(this.m, this.m, this.mTAnchor);



    for (var i = 0; i < this.lines.length; i++) {
      let l = this.lines[i];

      for (var k = 0; k < l.length; k++) {
        let vect = [];
        let vect2 = [];
        vect[0] = l[k][0];
        vect[1] = l[k][1];
        vect[2] = l[k][2];

        vec3.transformMat4(l[k], l[k], this.m);
        // verts.push(vect2);
      }
    }

    for (var i = 0; i < this.eyes.length; i++) {
      // let vect = [];
      // let vect2 = [];
      // vect[0] = this.eyes[i][0];
      // vect[1] = this.eyes[i][1];
      // vect[2] = this.eyes[i][2];

      vec3.transformMat4(this.eyes[i], this.eyes[i], this.m);
    }



    this.finalLines = []
    for (var i = 0; i < this.lines.length; i++) {
      let l = this.lines[i];

      this.finalLines.push(this.getPoints(l));
    }

  }

  getPoints(pts){
    this.spline.points = pts;
    this.sub = 3;
    let index;

    var array = []
    for (let i = 0; i < pts.length * this.sub; i ++ ) {
			index = i / ( pts.length * this.sub );
      array.push(this.spline.getPoint( index ));
		}

    // this.totalPts = array;

    return array;
  }

}

export default Owl;
